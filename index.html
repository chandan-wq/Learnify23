<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MathMaster üß†</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    /* Reset & Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: #f0f2f5;
      color: #333;
      height: 100vh;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background 0.5s ease;
    }

    /* Loading Screen */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, #4a00e0, #8e2de2, #1d976c, #93f9b9);
      background-size: 400% 400%;
      animation: gradientShift 8s ease infinite;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      color: white;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .loader-orb {
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.4);
      animation: pulse 2s infinite;
      margin-bottom: 30px;
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 0.7; }
      50% { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(1); opacity: 0.7; }
    }

    .loading-hint {
      font-size: 1.5rem;
      margin-top: 20px;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    /* Main App Container */
    #app {
      width: 100%;
      max-width: 500px;
      min-height: 100vh;
      padding: 20px;
      display: none;
      flex-direction: column;
      align-items: center;
    }

    /* General Buttons */
    .btn {
      padding: 14px 24px;
      margin: 10px;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      outline: none;
    }

    .btn-primary {
      background: #6a11cb;
      color: white;
      box-shadow: 0 4px 15px rgba(106, 17, 203, 0.3);
    }

    .btn-primary:hover, .btn-primary:active {
      background: #4a008f;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(106, 17, 203, 0.4);
    }

    /* Welcome Screen */
    .welcome-card {
      background: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 400px;
      text-align: center;
    }

    .welcome-card h2 {
      margin-bottom: 20px;
      color: #4a00e0;
    }

    .welcome-card input {
      width: 100%;
      padding: 14px;
      margin: 15px 0;
      border: 2px solid #ddd;
      border-radius: 12px;
      font-size: 1rem;
      transition: border 0.3s;
    }

    .welcome-card input:focus {
      border-color: #6a11cb;
      outline: none;
    }

    /* Home Screen */
    .greeting {
      font-size: 1.8rem;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 10px;
      text-align: center;
    }

    .score {
      font-size: 1.2rem;
      color: #6a11cb;
      margin-bottom: 30px;
    }

    .level-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      width: 100%;
    }

    @media (min-width: 600px) {
      .level-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .level-card {
      background: white;
      padding: 20px;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .level-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.15);
    }

    .level-card i {
      font-size: 2.5rem;
      margin-bottom: 10px;
      color: #6a11cb;
    }

    .level-card h3 {
      margin-bottom: 8px;
      color: #2c3e50;
    }

    .level-card p {
      font-size: 0.9rem;
      color: #7f8c8d;
    }

    /* Quiz Screen */
    .quiz-card {
      background: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 400px;
      text-align: center;
      margin-bottom: 20px;
    }

    .question {
      font-size: 1.5rem;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 20px;
    }

    .options-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    @media (min-width: 500px) {
      .options-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .option {
      padding: 14px;
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .option:hover {
      background: #e9ecef;
    }

    .option.correct {
      background: #d4edda;
      border-color: #c3e6cb;
      animation: pulseGreen 0.5s ease;
    }

    .option.incorrect {
      background: #f8d7da;
      border-color: #f5c6cb;
      animation: shakeRed 0.5s ease;
    }

    @keyframes pulseGreen {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); background: #c3e6cb; }
      100% { transform: scale(1); }
    }

    @keyframes shakeRed {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    /* Summary Screen */
    .summary-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 100;
    }

    .summary-card {
      background: white;
      padding: 30px;
      border-radius: 16px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 20px 50px rgba(0,0,0,0.2);
    }

    .summary-card h2 {
      margin-bottom: 10px;
      color: #2c3e50;
    }

    .summary-card p {
      font-size: 1.1rem;
      margin-bottom: 20px;
      color: #555;
    }
  </style>
</head>
<body>

  <!-- LOADING SCREEN -->
  <div id="loading-screen">
    <div class="loader-orb"></div>
    <div class="loading-hint" id="loading-hint">7 + 5 = ?</div>
  </div>

  <!-- MAIN APP -->
  <div id="app">
    <!-- Welcome Screen -->
    <div id="welcome-screen" class="welcome-card">
      <h2>Welcome to MathMaster!</h2>
      <p>Enter your name to get started.</p>
      <input type="text" id="name-input" placeholder="Your name" />
      <button class="btn btn-primary" id="continue-btn">Continue</button>
    </div>

    <!-- Home Screen -->
    <div id="home-screen" style="display:none;width:100%">
      <h2 class="greeting" id="greeting">Hello, User!</h2>
      <div class="score" id="total-score">Score: 0</div>
      <div class="level-grid">
        <div class="level-card" data-level="addition">
          <i>‚ûï</i>
          <h3>Addition</h3>
          <p>Test your adding skills</p>
        </div>
        <div class="level-card" data-level="subtraction">
          <i>‚ûñ</i>
          <h3>Subtraction</h3>
          <p>Sharpen your subtraction</p>
        </div>
        <div class="level-card" data-level="multiplication">
          <i>‚úñÔ∏è</i>
          <h3>Multiplication</h3>
          <p>Master the times tables</p>
        </div>
        <div class="level-card" data-level="division">
          <i>‚ûó</i>
          <h3>Division</h3>
          <p>Divide and conquer</p>
        </div>
        <div class="level-card" data-level="algebra">
          <i>üü∞</i>
          <h3>Algebra</h3>
          <p>Solve for x like a pro</p>
        </div>
      </div>
    </div>

    <!-- Quiz Screen -->
    <div id="quiz-screen" style="display:none;width:100%">
      <div class="quiz-card">
        <div class="question" id="question">6 + 8 = ?</div>
        <div class="options-grid" id="options-grid"></div>
      </div>
    </div>

    <!-- Summary Screen -->
    <div id="summary-screen" style="display:none;"></div>
  </div>

  <script>
    // IIFE to encapsulate the entire app
    (function () {
      // App state
      const state = {
        user: null,
        score: 0,
        currentLevel: '',
        questions: [],
        currentQuestionIndex: 0,
        correctCount: 0,
        totalQuestions: 10
      };

      // DOM Elements
      const $ = (selector) => document.querySelector(selector);
      const $$ = (selector) => document.querySelectorAll(selector);

      // Math hints for loading screen
      const mathHints = [
        '7 + 5 = ?', '12 √ó 3 = ?', 'x + 4 = 9 ‚Üí x=?',
        '18 ‚àí 9 = ?', '36 √∑ 6 = ?', '5¬≤ = ?', '2x = 10 ‚Üí x=?',
        '9 √ó 7 = ?', '‚àö64 = ?', '15 + ? = 23'
      ];

      // Show loading screen for 2.5s, then go to welcome/home
      const loadingHint = $('#loading-hint');
      let hintIndex = 0;

      const updateHint = () => {
        loadingHint.style.opacity = 0;
        setTimeout(() => {
          loadingHint.textContent = mathHints[hintIndex];
          loadingHint.style.opacity = 1;
          hintIndex = (hintIndex + 1) % mathHints.length;
        }, 500);
      };

      setInterval(updateHint, 2000);
      updateHint();

      setTimeout(() => {
        $('#loading-screen').style.opacity = 0;
        setTimeout(() => {
          $('#loading-screen').style.display = 'none';
          initApp();
        }, 500);
      }, 2500);

      // Initialize the app
      function initApp() {
        $('#app').style.display = 'flex';

        // Load user data from localStorage
        const savedUser = localStorage.getItem('mathQuizUser');
        const savedScore = localStorage.getItem('mathQuizScore');

        if (savedUser) {
          state.user = savedUser;
          state.score = savedScore ? parseInt(savedScore) : 0;
          showHomeScreen();
        } else {
          showWelcomeScreen();
        }

        setupEventListeners();
      }

      function showWelcomeScreen() {
        $('#welcome-screen').style.display = 'block';
        $('#home-screen').style.display = 'none';
        $('#quiz-screen').style.display = 'none';
      }

      function showHomeScreen() {
        $('#welcome-screen').style.display = 'none';
        $('#quiz-screen').style.display = 'none';
        $('#summary-screen').style.display = 'none';
        $('#home-screen').style.display = 'block';
        $('#greeting').textContent = `Hello, ${state.user}!`;
        $('#total-score').textContent = `Score: ${state.score}`;
      }

      function showQuizScreen() {
        $('#home-screen').style.display = 'none';
        $('#summary-screen').style.display = 'none';
        $('#quiz-screen').style.display = 'block';
        loadQuestion();
      }

      function loadQuestion() {
        const q = state.questions[state.currentQuestionIndex];
        $('#question').textContent = q.question;

        const optionsGrid = $('#options-grid');
        optionsGrid.innerHTML = '';

        q.options.forEach(option => {
          const div = document.createElement('div');
          div.className = 'option';
          div.textContent = option;
          div.onclick = () => checkAnswer(option);
          optionsGrid.appendChild(div);
        });
      }

      function checkAnswer(selected) {
        const q = state.questions[state.currentQuestionIndex];
        const options = $$('.option');
        const correct = q.answer;

        // Disable further clicks
        options.forEach(opt => (opt.style.pointerEvents = 'none'));

        let isCorrect = selected === correct;

        if (isCorrect) {
          state.correctCount++;
          state.score += 10;
        }

        // Highlight answers
        options.forEach(opt => {
          if (opt.textContent === correct) {
            opt.classList.add('correct');
          } else if (opt.textContent === selected && !isCorrect) {
            opt.classList.add('incorrect');
          }
        });

        // Save score
        localStorage.setItem('mathQuizScore', state.score);

        // Move to next question or summary
        setTimeout(() => {
          state.currentQuestionIndex++;
          if (state.currentQuestionIndex < state.totalQuestions) {
            loadQuestion();
          } else {
            showSummary();
          }
        }, 1200);
      }

      function generateQuestions(level) {
        const questions = [];
        for (let i = 0; i < state.totalQuestions; i++) {
          let question, answer, options;

          switch (level) {
            case 'addition':
              {
                const a = random(1, 50);
                const b = random(1, 50);
                question = `${a} + ${b} = ?`;
                answer = (a + b).toString();
                options = generateDistractors(parseInt(answer), 'number');
              }
              break;

            case 'subtraction':
              {
                const a = random(20, 100);
                const b = random(1, a - 1);
                question = `${a} - ${b} = ?`;
                answer = (a - b).toString();
                options = generateDistractors(parseInt(answer), 'number');
              }
              break;

            case 'multiplication':
              {
                const a = random(1, 12);
                const b = random(1, 12);
                question = `${a} √ó ${b} = ?`;
                answer = (a * b).toString();
                options = generateDistractors(parseInt(answer), 'number');
              }
              break;

            case 'division':
              {
                const b = random(1, 12);
                const a = b * random(1, 12);
                question = `${a} √∑ ${b} = ?`;
                answer = (a / b).toString();
                options = generateDistractors(parseInt(answer), 'number');
              }
              break;

            case 'algebra':
              {
                const a = random(2, 10);
                const b = random(1, 20);
                const x = random(1, 10);
                const result = a * x + b;
                question = `${a}x + ${b} = ${result} ‚Üí x = ?`;
                answer = x.toString();
                options = generateDistractors(x, 'number');
              }
              break;

            default:
              question = 'Error';
              answer = '0';
              options = ['1', '2', '3', '4'];
          }

          // Shuffle options
          shuffleArray(options);

          questions.push({ question, answer, options });
        }
        return questions;
      }

      function generateDistractors(correct, type) {
        const opts = [correct];
        while (opts.length < 4) {
          let wrong = type === 'number' ? correct + random(-5, 5) : correct;
          if (wrong !== correct && !opts.includes(wrong)) {
            opts.push(wrong);
          }
        }
        return opts;
      }

      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }

      function random(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function showSummary() {
        $('#quiz-screen').style.display = 'none';

        const summaryHTML = `
          <div class="summary-modal">
            <div class="summary-card">
              <h2>Quiz Complete!</h2>
              <p>Correct: ${state.correctCount} / ${state.totalQuestions}</p>
              <p>You earned <strong>${state.correctCount * 10}</strong> points!</p>
              <button class="btn btn-primary" id="retry-btn">Retry Level</button>
              <button class="btn" id="back-home-btn">Back to Home</button>
            </div>
          </div>
        `;

        $('#summary-screen').innerHTML = summaryHTML;
        $('#summary-screen').style.display = 'block';

        $('#retry-btn').onclick = () => startQuiz(state.currentLevel);
        $('#back-home-btn').onclick = () => showHomeScreen();
      }

      function startQuiz(level) {
        state.currentLevel = level;
        state.currentQuestionIndex = 0;
        state.correctCount = 0;
        state.questions = generateQuestions(level);
        showQuizScreen();
      }

      function setupEventListeners() {
        // Welcome screen
        $('#continue-btn').onclick = () => {
          const name = $('#name-input').value.trim();
          if (!name) {
            alert('Please enter your name!');
            return;
          }
          state.user = name;
          localStorage.setItem('mathQuizUser', name);
          localStorage.setItem('mathQuizScore', '0');
          showHomeScreen();
        };

        // Level selection
        $$('.level-card').forEach(card => {
          card.onclick = () => {
            const level = card.getAttribute('data-level');
            startQuiz(level);
          };
        });
      }
    })();
  </script>
</body>
</html>
